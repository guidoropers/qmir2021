---
title: "LearnR Exercises - Week 12 - Time-Series Cross-Sectional Analysis"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
library(learnr)
library(learnrhash)
library(highlight)
library(gradethis)

data(df_learnr12)
```

## Introduction

Welcome to this week's tutorial! This week you will run both a pooled model, a fixed effects model, compare the results and visualize predicted values for Japan an Uruguay! Before we run a time-series cross-sectional model, though, let's repeat some key contents of the lecture. 


## Knowledge questions

```{r q1, echo = FALSE}
question("Why does it make sense to use a TSCS model?",
  answer("Ommitted variable bias"),
  answer("Confounding"),
  answer("Exogenous shocks"),
  answer("All of the above", correct = T),
  random_answer_order = F,
  allow_retry = T,
  incorrect = "Hint: Check the lecture materials."
)

```


```{r q2, echo = FALSE}
question("What is **not** a constant effect within units?",
  answer("The electoral system", message = "How often has the electoral system in your home-country changed in your lifetime?"),
  answer("The unemployment rate of a country", correct = T),
  answer("Culture", message = "Though you may argue that culture is everchanging and subject to the understanding of the individual, for a FE-regresison we may assume that it is somewhat constant over time."),
  random_answer_order = TRUE,
  allow_retry = T,
  incorrect = "Hint: Check the lecture materials."
)

```



```{r q3, echo = FALSE}
question("When may we want to use a two-way FE model?",
  answer("When we want to test two competing explanations", message = "We can do this with or without a fixed effect!"),
  answer("When we want to account for two variables that are constant over time", message = "Two variables that are constant over time, but differ from unit to unit would be covered with a unit-fixed effect."),
  answer("When we want to account for differences between units that are constant over time and for exogenous shocks that affect all units simultaneously", correct = T),
  random_answer_order = TRUE,
  allow_retry = T,
  incorrect = "Hint: Check the lecture materials."
)

```


```{r q4, echo = FALSE}
question("What happens when we use a unit-fixed effect?",
  answer("It changes the intercept for each unit", correct = T),
  answer("It changes the slope for each unit"),
  answer("It runs a separate model for each unit"),
  random_answer_order = TRUE,
  allow_retry = T,
  incorrect = "Hint: Check the lecture materials."
)

```


## Coding Exercises

Let's get to the applied part of today's session! You will run a pooled model, a model including a fixed effect, compare the two and calculate predicted values for the fixed-effects model. But before we get started let's load the data called `QM2021-learnr12-data.csv'

**Comment GR: The data set should be pre-loaded as `df_learnr12`**

```{r loading_data, exercise = T}

```

We want you to create a dummy variable for democracy. The dummy should take the value "1" if the "democ"-variable takes a value greater than 6. Replicate the pooled model but include an interaction for the duration of World Bank membership and the newly created dummy. 

What is the coefficient of the interaction?





```{r exercise1, exercise = TRUE}
# 
```


```{r q5, echo = F}

question_text("What is the coefficient of the interaction?",
  answer("-0.14", correct = T),
  allow_retry = TRUE,
  incorrect = "Hint: specify the interaction with a '*' between the relevant terms."
)




```


Run the same model, but include a fixed-effect for the unit. What is the coefficient for the dummy now?

```{r exercise2, exercise = TRUE}
# 
```


```{r q6, echo = F}

question_text(" What is the coefficient for the dummy?",
  answer("-0.01", correct = T),
  allow_retry = TRUE,
  incorrect = "Hint: is the fixed-effect correctly specified?"
)




```





```{r q7, echo = FALSE}
question("Comparing the two coefficients, what do you conclude?",
  answer("Accounting for the unobserved, constant variation between countries has rendered the effect of democratic membership in the World Bank insignificant.", correct = T),
  answer("We have different numbers of observation and therefore the coefficients differ.", message = "Take a look at the number of observations included in each model. Are they the same or do they differ?"),
  answer("The coefficients are the same.", message = "If the coefficients are the same, you may want to retrace your steps and check your code whether there is an error."),
  random_answer_order = TRUE,
  allow_retry = T
)

```


In a final step, we want to visualize the results. Remember from the last session that visualizing results can help us interpret the results. In the following section, the model has already been specified. Please calculate and plot the predicted probabilities for membership in the **World Bank**. Specify scenarios for Uruguay and Japan. 


```{r exercise3, exercise = TRUE}

m_fe <- lm(n_RAI ~ length_EU + length_world + democ + gdp_capita + population_size + nationalization + country_name, data = data) 


```




```{r q8, echo = FALSE}
question("Looking at the predicted values, in which country is the preiction for sub-national authority higher?",
  answer("Japan", message = "Keep in mind that confidence intervals are important!"),
  answer("Uruguay"),
  answer("Unclear, because the CIs overlap.", correct = T),
  random_answer_order = TRUE,
  allow_retry = T)

```



## Submit

```{r context="server"}
learnrhash::encoder_logic()
```

```{r encode, echo=FALSE}
learnrhash::encoder_ui(default_ui(url =
  "https://ilias.uni-mannheim.de/ilias.php?baseClass=ilObjSurveyGUI&ref_id=1097905&cmd=infoScreen"))
```